' Gambas class file

Private $de As String

Public Sub _new(de As String)

  ' $de = de

End

Public Sub Form_Open()

  ' Dim r As Result
  ' Dim n As Integer
  ' Dim icono As PictureBox
  ' Dim ar As String[]
  ' Dim s As String
  '
  ' dSince.Value = Now()
  ' cp1.Clear()
  ' cp1.Add(Color.lighter(Color.lighter(Color.yellow)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.green)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.blue)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.red)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.violet)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.darkcyan)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.Magenta)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.orange)))
  ' cp1.Add(Color.lighter(Color.lighter(Color.pink)))
  ' cp1.Add(Color.White)
  ' cp1.index = Rnd(0, 5)
  ' texto.Background = cp1.Current
  ' texto.Format.color = Color.Black
  ' r = Connections[Application.Name].Exec("Select nick from usuarios order by nick")
  ' para.List = r.All("nick")
  ' para.Index = para.Find($de)
  ' texto.Pos = 1
  ' texto.EnsureVisible()
  ' texto.SetFocus()

End

Public Sub cp1_Click()

  ' texto.Background = cp1.Current
  ' texto.Foreground = Color.Black
  ' texto.Format.color = Color.Black

End

Public Sub bCancel_Click()

  Me.Close

End

Public Sub bSend_Click()

  ' Dim spara, id, sRt As String
  ' Dim n, i As Integer
  '
  ' Me.hide()
  ' id = Format(Now(), "yyyymmddhhnnssuu")
  ' srt = Texto.Text
  ' ' If Not mDB.Conectar() Then Return
  ' Connections[Application.Name].Exec("insert into postits (id,de,para,fecha,texto,desde,oculto,x,y,color,leido) Values (&1,&2,&3,&4,&5,&6,&7,&8,&9,&{10},&{11})", Null, $de, para.text, Now(), srt, dSince.Value, False, 0, 0, texto.Background, False)
  ' If Error Then
  '   Message.Error(Error.Text & " " & Error.Where)
  ' Endif
  ' Try Me.Close

End

Public Sub texto_GotFocus()

  texto.Foreground = Color.Black

End
